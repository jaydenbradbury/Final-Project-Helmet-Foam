#THIS IS THE PLOT FOR CHEMINDEX CHANGE IN ESTATIC OVER TIME (CYCLES)
# Plot with group average lines by chemindex
df_clean %>%
  group_by(ChemIndex, Cycle) %>%
  summarise(mean_Estatic = mean(Estatic_MPA, na.rm = TRUE), .groups = "drop") %>%
  ggplot(aes(x = Cycle, y = mean_Estatic, color = factor(ChemIndex), group = ChemIndex)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  labs(
    title = "Estatic_MPA Across Cycles by Foam Type",
    x = "Cycle",
    y = "Mean Estatic_MPA",
    color = "Foam (chemindex)"
  ) +
  theme_minimal()

#THIS IS THE PLOT FOR POROSITY CHANGE IN ESTATIC OVER TIME (CYCLES)
# Plot with group average lines by porosity
df_clean %>%
  group_by(Porosity, Cycle) %>%
  summarise(mean_Estatic = mean(Estatic_MPA, na.rm = TRUE), .groups = "drop") %>%
  ggplot(aes(x = Cycle, y = mean_Estatic, color = factor(Porosity), group = Porosity)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  labs(
    title = "Estatic_MPA Across Cycles by Porosity",
    x = "Cycle",
    y = "Mean Estatic_MPA",
    color = "Foam (Porosity)"
  ) +
  theme_minimal()

#THIS IS THE PLOT FOR CHANGE IN ESTATIC OVER TIME FOR EACH UNIQUE COMBO OF POROSTIY AND CHEM INDEX
df_clean %>%
  group_by(ChemIndex, Porosity, Cycle) %>%
  summarise(mean_Estatic = mean(Estatic_MPA, na.rm = TRUE), .groups = "drop") %>%
  ggplot(aes(
    x = Cycle,
    y = mean_Estatic,
    group = interaction(ChemIndex, Porosity),
    color = interaction(ChemIndex, Porosity)
  )) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  labs(
    title = "Estatic_MPA Across Cycles by Foam Type and Porosity",
    x = "Cycle",
    y = "Mean Estatic_MPA",
    color = "chemindex / Porosity"
  ) +
  theme_minimal()


```{r}
ggplot(df_clean, aes(x = factor(ChemIndex), fill = factor(ChemIndex))) +
  geom_bar() +
  labs(title = "Count of Each Foam Type",
       x = "Foam Type",
       y = "Count") +
  theme_minimal() +
  theme(legend.position = "none")
```

```{r}
ggplot(df_clean, aes(x = factor(Porosity), fill = factor(Porosity))) +
  geom_bar() +
  labs(title = "Count of Each Foam Type",
       x = "Foam Type",
       y = "Count") +
  theme_minimal() +
  theme(legend.position = "none")
```
```{r}
## corr matrix for estatic mpa, tan delta (damping), and NVP
 df_clean %>%
  select(Estatic_MPA, tandelta, NVP) %>%
  cor(use = "complete.obs")

```
```{r}
df_clean %>%
  group_by(ChemIndex, tandelta) %>%
  summarise(mean_Estatic = mean(Estatic_MPA, na.rm = TRUE), .groups = "drop") %>%
  ggplot(aes(x = tandelta, y = mean_Estatic, color = factor(ChemIndex), group = ChemIndex)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  labs(
    title = "Estatic_MPA vs. tan delta by Foam Type",
    x = "tan delta",
    y = "Mean Estatic_MPA",
    color = "Foam (chemindex)"
  ) +
  theme_minimal()
```

```{r}
df_clean %>%
  group_by(Porosity, tandelta) %>%
  summarise(mean_Estatic = mean(Estatic_MPA, na.rm = TRUE), .groups = "drop") %>%
  ggplot(aes(x = tandelta, y = mean_Estatic, color = factor(Porosity), group = Porosity)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  labs(
    title = "Estatic_MPA vs. tan delta by Foam Type",
    x = "tan delta",
    y = "Mean Estatic_MPA",
    color = "Foam (porosity)"
  ) +
  theme_minimal()
```

```{r}
df_clean %>%
  group_by(ChemIndex, Porosity, tandelta) %>%
  summarise(mean_Estatic = mean(Estatic_MPA, na.rm = TRUE), .groups = "drop") %>%
  ggplot(aes(
    x = tandelta,
    y = mean_Estatic,
    group = interaction(ChemIndex, Porosity),
    color = interaction(ChemIndex, Porosity)
  )) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  labs(
    title = "Estatic_MPA Across tandeltas by Foam Type and Porosity",
    x = "tandelta",
    y = "Mean Estatic_MPA",
    color = "chemindex / Porosity"
  ) +
  theme_minimal()
```
```{r}
df_clean %>%
  group_by(ChemIndex, Porosity, Stress_kPa) %>%
  summarise(mean_Estatic = mean(Estatic_MPA, na.rm = TRUE), .groups = "drop") %>%
  ggplot(aes(
    x = Stress_kPa,
    y = mean_Estatic,
    group = interaction(ChemIndex, Porosity),
    color = interaction(ChemIndex, Porosity)
  )) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  labs(
    title = "Estatic_MPA vs. Stress by Foam Type and Porosity",
    x = "stress",
    y = "Mean Estatic_MPA",
    color = "chemindex / Porosity"
  ) +
  theme_minimal()
```
